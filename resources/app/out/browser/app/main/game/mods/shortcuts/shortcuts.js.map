{"version":3,"sources":["../src/browser/app/main/game/mods/shortcuts/shortcuts.ts"],"names":[],"mappings":"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","file":"shortcuts.js","sourcesContent":["import {Option} from \"../../../../../shared/settings/settings.service\";\nimport {NgZone} from '@angular/core';\nimport {TranslateService} from 'ng2-translate';\nimport {Tab} from \"../../../tab/tab\";\nimport * as async from 'async';\nimport {ShortCuts} from \"../../../../shortcuts/shortcuts\";\n\nexport class Shortcuts {\n\n    private wGame: any | Window;\n    private params: Option.Shortcuts;\n    private shortcuts: ShortCuts;\n    private events: any[] = [];\n\n\n    constructor(wGame: any, params: Option.Shortcuts){\n        this.wGame = wGame;\n        this.params = params;\n        this.shortcuts = new ShortCuts(this.wGame);\n\n        let onCharacterSelectedSuccess = () => {\n            this.bindAll();\n\n            let onDisconnect = () => {\n                this.shortcuts.unBindAll();\n            };\n\n            this.wGame.gui.on(\"disconnect\", onDisconnect);\n            this.events.push(() => {\n                this.wGame.gui.removeListener(\"disconnect\", onDisconnect);\n            });\n        };\n\n        this.wGame.gui.playerData.on(\"characterSelectedSuccess\", onCharacterSelectedSuccess);\n        this.events.push(() => {\n            this.wGame.gui.playerData.removeListener(\"characterSelectedSuccess\", onCharacterSelectedSuccess);\n        });\n\n        if(this.wGame.gui.isConnected){\n            onCharacterSelectedSuccess();\n        }\n    }\n\n    private bindAll(){\n\n        // end turn\n        this.shortcuts.bind(this.params.diver.end_turn, () => {\n            this.wGame.gui.fightManager.finishTurn()\n        });\n\n        // open chat\n        this.shortcuts.bind(this.params.diver.open_chat, () => {\n            this.wGame.gui.chat.activate()\n        });\n\n        // spell\n        async.forEachOf(this.params.spell, (shortcut: string, index: number) => {\n            this.shortcuts.bind(shortcut, () => {\n                this.wGame.gui.shortcutBar._panels.spell.slotList[index].tap();\n                //this.tab.window.gui.shortcutBar.panels.spell.slotList[index].tap();\n            });\n        });\n\n        // item\n        async.forEachOf(this.params.item, (shortcut: string, index: number) => {\n            this.shortcuts.bind(shortcut, () => {\n                //this.tab.window.gui.shortcutBar.panels.item.slotList[index].tap();\n                this.wGame.gui.shortcutBar._panels.item.slotList[index].tap();\n            });\n        });\n\n        // interfaces\n        async.forEachOf(this.params.interface.getAll(), (inter: any) => {\n            this.wGame.gui.menuBar._icons._childrenList.forEach((element: any, index: number) => {\n                if (element.id.toUpperCase() == inter.key.toUpperCase()) {\n                    this.shortcuts.bind(inter.value, () => {\n                        let newIndex = index;\n                        this.wGame.gui.menuBar._icons._childrenList[newIndex].tap();\n                    });\n                    return;\n                }\n            });\n        });\n\n        // close interfaces\n        this.shortcuts.bindVanilla('escape', () => {\n            if (this.wGame.gui.chat.active) {\n                this.wGame.gui.chat.deactivate();\n            }\n            else {\n                for (let i = this.wGame.gui.windowsContainer._childrenList.length - 1 ; i >= 0 ; i--)  {\n                    let win = this.wGame.gui.windowsContainer._childrenList[i];\n                    if (win.isVisible()) {\n                        win.close();\n                        break;\n                    }\n                }\n            }\n        });\n    }\n\n\n    public reset() {\n        this.shortcuts.unBindAll();\n\n        this.events.forEach((event) => {\n            event();\n        });\n        this.events = [];\n    }\n\n\n}\n"]}